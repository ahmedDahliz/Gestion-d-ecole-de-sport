<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>paiement</title>
    <link rel="stylesheet" href="../node_modules/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="../node_modules/datatables.net-bs4/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="../assets/css/style.css" type="text/css"/>
    <link rel="stylesheet" href="../assets/fontawesome/css/all.css" type="text/css"/>
    <script>
      window.jQuery = window.$ = require('jquery');
    </script>
  </head>
  <body>
    <div class="loader" role="status">
      <!-- <div class="loader"></div> -->
      <img src="../assets/image/pageLoaderOld2.gif" class="alling-middel mx-auto" alt="">
    </div>
    <div id="mainMenu">
      <button id="J" class="btn btn-danger"><i class="fas fa-users"></i> Joueurs</button>
      <button id="G" class="btn btn-danger"><i class="fas fa-grip-horizontal"></i> Categorie/Groupes</button>
      <button id="E" class="btn btn-danger"><i class="fas fa-chalkboard-teacher"></i> Entreneurs</button>
      <button id="P" class="btn btn-danger" style="background: #b54747; color: black"><i class="fas fa-file-invoice-dollar"></i> Payment</button>
      <button id="U" class="btn btn-danger"><i class="fas fa-user-cog"></i> Utilisateur</button>
      <button id="D" class="btn btn-danger"><i class="fas fa-power-off"></i> Deconnexion</button>
    </div>
    <div id="main">
      <div class="w-100 text-center">
        <h2 class="m-2"><i class="fas fa-file-invoice-dollar"></i> Gestion des paiement</h2>
      </div>
      <h5 class="m-3">Paiement pour le mois : <span id="monthName"></span></h5>
      <div class="m-3">
        <table id="table_paiement" class="display table table-hover">
          <thead class="thead-dark">
            <tr>
              <th><i class="fas fa-cog"></i></th>
              <th>Nom</th>
              <th>Prenom</th>
              <th>Categorie/Groupe</th>
              <th>Date de paiement</th>
              <th>Paiement pour</th>
              <th>Montant</th>
            </tr>
          </thead>
          <tbody>

          </tbody>
        </table>
      </div>
      <!-- <div class="m-2">
        <button type="button" id="showPlayer" class="btn btn-show" disabled><i class="fas fa-eye"></i> Afficher</button>
        <button type="button" id="ajouter" class="btn btn-add"><i class="fas fa-plus"></i> Ajouter</button>
        <button type="button" id="deletePlayer" class="btn btn-delete" disabled><i class="fas fa-user-times"></i> Supprimer</button>
      </div> -->
    </div>
    <!-- Edit modal for days -->
    <div id="myModalPayment" class="modal">

      <!-- The Close Button -->
      <span id="closePayment" class="close">&times;</span>

      <!-- Modal Content -->
      <div  class="modal-content w-75 text-center p-3">
        <h6>Date de paiement : <span id="date_now"></span></h6>
        <table class="table">
          <tr>
            <td>Nom et prenom : </td>
            <td><input type="text" id="fname_lname" class="form-control form-control-sm m-1" readonly/></td>
          </tr>
          <tr>
            <td>Categorie/Groupe : </td>
            <td><input type="text" id="cat_grp" class="form-control form-control-sm m-1" readonly></td>
          </tr>
          <tr>
            <td>Paiement pour : </td>
            <td style="max-width">
              <div id="month_container" style="text-align: left; max-height: 100px; overflow-y: scroll;">
                <table id="table_paiement_for">
                  <tr>
                    <td><input type="checkbox" name="payment_for" value="0" /> janvier </td>
                    <td><input type="checkbox" name="payment_for" value="1" /> février </td>
                    <td><input type="checkbox" name="payment_for" value="2" /> mars </td></td>
                  </tr>
                  <tr>
                    <td><input type="checkbox" name="payment_for" value="3" /> avril </td>
                    <td><input type="checkbox" name="payment_for" value="4" /> mai </td>
                    <td><input type="checkbox" name="payment_for" value="5" /> juin </td>
                  </tr>
                  <tr>
                    <td><input type="checkbox" name="payment_for" value="6" /> juillet </td>
                    <td><input type="checkbox" name="payment_for" value="7" /> août </td>
                    <td><input type="checkbox" name="payment_for" value="8" /> septembre </td>
                  </tr>
                  <tr>
                    <td><input type="checkbox" name="payment_for" value="9" /> octobre </td>
                    <td><input type="checkbox" name="payment_for" value="10" /> nobembre</td>
                    <td><input type="checkbox" name="payment_for" value="11" /> décembre</td>
                  </tr>
                </table>
              </div>
            </td>
          </tr>
          <tr>
            <td>Montant : </td>
            <td class="input-box"><input type="text" id="price" class="form-control form-control-sm m-1" value="50"><span style="top: 19px;" class="unit">DH</span></td>

          </tr>
          <tr>
            <td><input type="hidden" id="idPlayerPayment"> <button class="btn btn-add" id="submit_payment"><i class="fas fa-check"></i> Valider</button><br>
            </td>
            <td><input type="hidden" id="idDays"><span class="text-warning font-weight-bold" id="msg_edit_day"></span></td>
          </tr>
        </table>
      </div>


      <!-- Modal Caption (Image Text) -->
      <div id="caption">Valider paiement</div>
    </div>
    <!-- You can also require other files to run in this process -->
    <script src="../renderer.js"></script>
    <script src="../config/scripts/db_paiement.js"></script>
    <script src="../node_modules/datatables.net-bs4/js/dataTables.bootstrap4.min.js"></script>
    <script>
    // Get the modal
    var modalPayment = document.getElementById("myModalPayment");

    // Get the <span> element that closes the modal
    var spanPayment = document.getElementById("closePayment");

    // When the user clicks on <span> (x), close the modal
    spanPayment.onclick = function() {
      modalPayment.style.display = "none";
    }
      $(document).ready(function () {
        $('table#table_paiement').on('click', 'button.payment', function(event){
            modalPayment.style.display = "block";
            let date = new Date();
            $('span#date_now').html(date.toLocaleString('fr-FR',  { year: 'numeric', month: 'long', day: 'numeric' }));
            $('input#fname_lname').val($(this).closest('tr').find('td').eq(2).text()+' '+$(this).closest('tr').find('td').eq(1).text());
            $('input[name=payment_for][value='+date.getMonth()+']').prop('checked', true);
            $('input[name=payment_for][value='+date.getMonth()+']').closest('td').addClass('checkedCell');
            if (date.getMonth() >= 7) {
              $("div#month_container").animate({ scrollTop: $("div#month_container").height()});
            }
            $('input#cat_grp').val($(this).closest('tr').find('td').eq(3).text());
            $('input#idPlayerPayment').val($(this).closest('tr').find('td').find('input[type=hidden]#idPlayer').val());
        });

        $('table#table_paiement_for td').on('click', function(event){
          if ($(this).find('input[type=checkbox]').prop('checked') == false) {
            $(this).find('input[type=checkbox]').prop('checked', true)
            $(this).addClass('checkedCell');
          }else{
            $(this).find('input[type=checkbox]').prop('checked', false)
            $(this).removeClass('checkedCell');
          }
        })


      });
    </script>
  </body>
</html>
